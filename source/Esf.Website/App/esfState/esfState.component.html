<div fxFlexFill fxFlex fxLayout="column">
    <md-toolbar color="primary" fxLayout="row">
        <a class="brand" href="#">ESFiddle</a>
        <button md-button
                (click)="saveCommand.run(state)"
                [disabled]="!saveCommandEnabled"
                class="save-command">
            <md-icon *ngIf="!saveCommandInProgress">save</md-icon>
            <md-spinner *ngIf="saveCommandInProgress" color="accent"></md-spinner>
            <span>Save</span>
        </button>
        <button md-button
                (click)="runQueryCommand.run(state)" 
                [disabled]="!runCommandEnabled"
                class="run-command">
            <md-icon *ngIf="!runCommandInProgress">play_arrow</md-icon>
            <md-spinner *ngIf="runCommandInProgress" color="accent"></md-spinner>
            <span>Run</span>
        </button>
    </md-toolbar>
    <div fxLayout="row" fxFlex>
        <vertical-split-view fxLayout="column" (onResize)="splitViewResized()" fxFlex>
            <view1 fxLayout="column">
                <horizontal-split-view (onResize)="splitViewResized()">
                    <view1 fxLayout="column" fxFlex>
                        <label class="noselect">Mapping</label>
                        <div class="editor-error" *ngIf="mappingInputErrors && mappingInputErrors.length > 0">
                            <ul>
                                <li *ngFor="let error of mappingInputErrors">{{error}}</li>
                            </ul>
                        </div>
                        <div class="mapping-editor" [(text)]="state.mapping" json-editor [readOnly]="!editorsEnabled" [resizeTrigger]="onSplitViewResized" fxFlex></div>
                    </view1>
                    <view2 fxLayout="column" fxFlex>
                        <label class="noselect">Documents</label>
                        <div class="editor-error" *ngIf="documentsInputErrors && documentsInputErrors.length > 0">
                            <ul>
                                <li *ngFor="let error of documentsInputErrors">{{error}}</li>
                            </ul>
                        </div>
                        <div class="documents-editor" [(text)]="state.documents" json-editor [readOnly]="!editorsEnabled" [resizeTrigger]="onSplitViewResized" fxFlex></div>
                    </view2>
                </horizontal-split-view>
            </view1>
            <view2 fxLayout="column">
                <horizontal-split-view (onResize)="splitViewResized()">
                    <view1 fxLayout="column" fxFlex>
                        <label class="noselect">Query</label>
                        <div class="editor-error" *ngIf="queryInputErrors && queryInputErrors.length > 0">
                            <ul>
                                <li *ngFor="let error of queryInputErrors">{{error}}</li>
                            </ul>
                        </div>
                        <div class="query-editor" [(text)]="state.query" json-editor [readOnly]="!editorsEnabled" [resizeTrigger]="onSplitViewResized" fxFlex></div>
                    </view1>
                    <view2 fxLayout="column" fxFlex>
                        <label class="noselect">Result</label>
                        <div class="editor-error" *ngIf="!!queryError">{{queryError}}</div>
                        <div class="result-viewer" [text]="queryResult" json-editor [readOnly]="true" [resizeTrigger]="onSplitViewResized" fxFlex></div>
                    </view2>
                </horizontal-split-view>
            </view2>
        </vertical-split-view>
    </div>
</div>